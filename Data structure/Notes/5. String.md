## 5. 字符串
### 5.1 什么是串？
字符串，又可以称作为“串”，也是一种数据结构：
- **定义**：串（String）由零个或者多个字符char类型组成的**有限**序列。
- 一般可以记为s = "a1 a2 a3 ... an" (n>=0)，串可以为空串(n=0)
- 子串和主串，例如"Jlee"是"EisweinJlee"的子串，反过来是主串。

同样可以用：顺序存储、链式存储。而一般来说，都是在电脑里用顺序存储，因为在应用的时候，字符串很少插入删除中间的字符，结构很稳定，前后逻辑关系强。

### 5.2 字符串的比较
应用：密码比较，文本内容比较。下面的内容字符串都是从下标1开始。

**BF算法(Brute Force)**
两个字符串S和T，长度分别为N和M(N>M)，在S中找到和T相同的部分。
如果S[1]和T[1]相同，则接着比较S[2]和T[2]，以此类推一直到T[M]相同就完成。如果S[1]和T[1]不相同，则从S[2]和T[1]比较，以此类推。

最坏的情况下要进行M*(N-M+1)次比较，时间复杂度O(M*N)。效率很低，很粗暴。

这里S是主串，T是一个子串，这种子串定位操作被称作为**串的模式匹配**。

**KMP算法(Knuth-Morris-Pratt)**
减少没必要的回溯，可以有效避免重复遍历的情况。可以分析子串里面字符的关系，跳过一些没有必要的回溯，比如
**启发1**：直接跳到失配项
S = "ABCDABCD"，T = "ABD"，子串T中，T[1] != T[2] != T[3]。
那么在第一次迭代对比的时候，S[1] = T[1]，S[2] = T[2]，S[3] != T[3]，就能推出S[2] != T[1]。
那么第二次迭代的时候，没必要考虑S[2]和T[1]了，直直接跳到S[3]和T[1]的比较，从减少了没必要的比较。

**启发2**：和T[1]相等的话不跳过
S = "www.aaa"，T = "ww."，子串中T[1] = T[2] != T[3]。
在第一次比较后，最后一个字符失配S[3] != T[3]，根据启发1可以跳到直接跳到S[3]和T[1]会漏掉答案。但是因为我们知道S[1]=T[1]=T[2]=S[2]，所以第二次循环不能跳过S[2]和T[1]。

**启发3**：失配位置前方字符串的前部和后部有完全匹配的
S = "bbsbbs.aaa"，T = "bbsbbc"。
第一次比较后，T[6]位置失配。T[6]失配位置的前方5个字符"bbsbb"，前面两个bb和后面两个bb是相同的，所以下一次直接从S[6]和T[3]对比就行了，S[i]的i不用回溯到1了。

**启发4**：考虑失配位置前方字符串，前部和后部可以更大
S = "ssssassssb"，T = "ssssb"。
第一次比较后，T[5]位置失配，T[5]前方四个字符"ssss"，可以分为前部sss和后部sss，3个匹配，所以i=5保持不动，j=3+1，拿S[5]和T[4]比较。T[4]失配，T[4]前面"sss"，2个匹配，i=5不变，j=2+1，直接S[5]和T[3]比较。以此类推，最后S[5]和T[1]比较后不匹配，常规到S[6]和T[1]比。
看出了一个规律，我们可以个T字符串一个NEXT数组，记录某一个字符前面的字符串的前部后部相同字符数+1的值。这样做，就可以方面直接跳T[j]的位置，中间节约了很多没必要的反复比较相同的部分。

根据这类思路启发，来建立的KMP算法。

### 5.3 KMP 算法分析
**NEXT数组代码**
当模式匹配串T失配的时候，NEXT数组对应失配元素可以指导T串的哪个元素进行下一轮的匹配。（启发3和启发4感受）

    typedef char* String;
    void get_next(String T, int *next){
	    int i=1, j=0; 
	    // i对应后部位置，j对应前部位置
	    next[1] = 0;
	    
	    while(i<T[0]){
		    if(j==0 || T[i] == T[j]){
			    i++;
			    j++;
			    if(T[i] != T[j]) // 一般情况
				    next[i] = j;
				else // 如果字符相同的话可以直接跳到前面
					next[i] = next[j];
			}
			else{
				j=next[j];//前部往前面挪
			}
		}
	}

**KMP代码**
next数组代码已经写好的话，只需要利用BF算法的思想，但是回溯的时候只需要回溯`j=next[j]`，就可以跳过很多T[j]没必要的对比，BF算法的效率被大大优化。
（具体代码见github的库）


