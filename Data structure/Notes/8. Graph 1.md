## 8. 图
线性表是个一对一的关系，树形结构中是一对多的层次关系，而图是一种多对多的复杂模型。当我们研究人与人的关系，高维度的点之间的关系，就需要用图结构来研究了。

### 8.1 图的定义

**图（Graph）** 是由 **顶点（Vertex）** 的有穷非空集合，和顶点间 **边（Edge）** 的集合组成，通常表示为：$G(V,E)$。因为图这种复杂结构的诞生，随着图论的丰富，也产生了很多定义：

**图的相关定义**

- **无向边**：若顶点Vi到Vj之间的边没有方向，则称为无向边，用无序偶(Vi,Vj)表示。
- **有向边**：若有方向，称作有向边，或者**弧（Arc）**，有序偶来表示<Vi,Vj>来表示，Vi是弧尾，Vj是弧头（从尾指向头）。
- **简单图**：图结构中，若不存在顶点指向自身的边，且一条边不会重复出现，就称为简单图。（应用最为广泛）
- **无向完全图**：在无向图中，任意两个顶点都有边，就称为无向完全图。含有$n$个顶点的无向完全图有$n*(n-1)/2$条边。
- **有向完全图**：在有向图中，任意两个顶点都有两条往来的弧，就称为有向完全图。则含有$n$个顶点的有向完全图有$n*(n-1)$条边。
- **稀疏图和稠密图**：是个模糊的概念，都是相对而言，通常认为边或弧数小于$n*\log n$的图，称为稀疏图；反之是稠密图。
- **权与网络**：有些图的边或者弧带有数值（例如道路长度），这种赋予的数值叫做**权（Weight）**，带权的图通常被称为**网（Network）**。
- **子图**：假设有两个图$G1=(V1,E1)$和$G2=(V2.E2)$，如果$V2\subseteq V1$且$E2\subseteq E1$，则G2是G1的**子图（Subgraph）**。

**图的顶点、边之间的关系**

- 对于无向图$G=(V,E)$，如果边$(V1,V2)\in E$，则称顶点$V1$和$V2$是**邻接点（Adjacent）**。边$(V1,V2)$则是**依附（Incident）** 于顶点$V1$和$V2$，或者说边与$V1$和$V2$相关联。
- 顶点$V$的**度（Degree）** 是和$V$相关联的边的树木，记为$TD(V)$。
- 对于有向图$G=(V,E)$，如果弧$\langle V1,V2 \rangle\in E$，则称顶点$V1$邻接到顶点$V2$，顶点$V2$邻接自顶点$V1$，突出方向性。
- 顶点$V$为头的弧的数目称为$V$的**入度（InDegree）**，记为$ID(V)$，以$V$为尾的弧的数目称为$V$的**出度（OutDegree）**，记为$OD(V)$，因此顶点的度为$TD(V)=ID(V)+OD(V)$。

**路径与连通图**

- **路径（Path）**：无向图$G=(V,E)$中$V1$到$V2$经过的边的集合，称为路径。如果G是有向图，路径也需要遵循弧的方向。
- 如果路径的第一个顶点，和最后一个顶点相同的话，路径可以称作为**回路或环（Cycle）**。环的路径过程中不经过相同的顶点，称为**简单回路/简单环**，否则不是。
- **连通/连通图**：如果V1和V2之间存在路径，则称V1和V2是**连通**的。如果无向图G中，任意两个顶点都是连通的，就称G为**连通图（Connected Graph）**。
- **连通分量**：无向图中的极大连通子图，称为**连通分量**。
- **强连通图**：仅仅对于有向图G而言，如果任意对顶点都存在路径，则G是**强连通图**。同样，有向图的极大强连通子图也称为**强连通分量**。

**图与树的关系**

- **连通图的生成树**： 是连通图的一个极小连通子图，它包含全部n个顶点，但只有能够构成一棵树的n-1条边。
- **有向图变有向树**：有向图恰好有一个顶点入度为0，其余顶点都是入度为1，这样的有向图可以拆分成树或者森林（多棵树）。

### 8.2 图的存储结构
图是一种多对多的数据结构，且任意顶点都可以被看做为起点，顶点间没有任何次序关系。又因为顶点的度都各不相同，纯粹用多重链表来描述图，会导致资源的浪费。一共有5种图的存储结构，邻接矩阵、邻接表、十字链表、邻接多重表、

**A1. 邻接矩阵（无向图）**

分别存放顶点和边两个结构。顶点因为不区分大小、主次，所以可以一维数组来保存；边和弧的信息可以用二维数组，即**邻接矩阵（Adjacency Matrix）**，来存储信息，如果顶点$V_i$和顶点$V_j$是邻接的，邻接矩阵的$edge[i][j] = edge[j][i] = 1$，否则为0，对角线上$edge[i][i]=0$，它是个对称矩阵。

- 判断两个顶点是否邻接，就看邻接矩阵元素。
- 某个顶点的度，其实就是邻接矩阵第i行（或第i列）的元素的和。
- 某个顶点所有邻接顶点，就扫描邻接矩阵第i行（或第i列）为1的元素位置。

**A2. 邻接矩阵（有向图）**

只需要将无向图的邻接矩阵进行修改，假若有一条弧从$V_i$到$V_j$，则邻接矩阵中$arc[i][j]=1$，而且如果有指向自身的弧，$arc[i][i]=1$也成立。一般情况下，不再是对称矩阵。

- 顶点$V_i$的出度，是邻接矩阵第i行的元素和；入度，是邻接矩阵第i列的和。

**A3. 邻接矩阵（网）**

网只是在边和弧上赋予了权值，于是我们只需要在邻接矩阵上添加数值来替代1就可以。但是，在网的邻接矩阵中，0代表顶点自身指向自身，而对于不邻接的顶点，则填入$\infty$正无穷来替代0（$\infty$的大小视应用而定，通常用远大于所有权值的值）。

- 判断顶点属性的时候，无法用和的方式，只能判断小于最长的边的元素个数。


**Remark**：邻接矩阵的使用很方便很直观，但会产生**空间浪费**，有n个顶点就需要n^2个位置来存储。例如，一个图顶点很多，但是边只有一条，那么邻接矩阵中只有单单1个数字。因此，我们考虑邻接表的方式来节约空间。

**B1. 邻接表（无向图）**

把数组和链表结合起来存储，应用于图结构，我们称这种方式为**邻接表（Adjacency List）**，它依照这样的方式：

- 图中顶点用一个一位数组存储（也可以用链表，不过数组可以较容易的读取）。
- 图中每个顶点Vi的所有邻接点构成一个线性表，由于邻接点个数不一定，所以就考虑用单链表来存储。

![邻接表无向图](https://user-images.githubusercontent.com/26374671/80806559-f4e33200-8bf5-11ea-87d5-dee73d81415a.png)

**B2. 邻接表（有向图）**

和无向图类似的，当顶点是弧尾（出发点）的时候，把弧头（到达点）的序号加入链表中，这是可以表示顶点出度的邻接表；如果反过来，在邻接表中存放弧尾的序号，称为逆邻接表，这样方便计算入度。

![邻接表无向图](https://user-images.githubusercontent.com/26374671/80806674-47bce980-8bf6-11ea-92b4-303f13545992.png)

**B3. 邻接表（网）**

只需要在链表中的结点加多一个数据域来存放权值就可以了。

**Remark**：虽然邻接表优化了存储空间的问题，但是对于有向图来说，我们构建了邻接表表达顶点出度，有时候为了方便得到顶点入度，需要构建逆邻接表，比较繁琐。如果结合邻接表和逆邻接表，我们可以得到：

**C. 十字链表（Orthogonal List）**

有向图的邻接表的顶点结构只有两个元素，而十字链表的顶点结构多加一个元素，一边指向邻接表，一边指向逆邻接表：
| data | first_in | first_out |
|--|--|--|
而且边表结点的结构变为：
| tail vertex | head vertex | head link | tail link | 
|--|--|--|--|
边表里面的链表结点，既可以被弧尾的first_out索引到（如图蓝色箭头），也可以被弧头的first_in给索引到（如图红色箭头）。如图，V0有两个入度，第一次索引first_in可以找到弧<V1,V0>，再索引head link可以找到弧<V2,V0>。

![十字链表](https://user-images.githubusercontent.com/26374671/80807889-43460000-8bf9-11ea-9fdc-dfd5377dd861.png)

**Remark**：十字链表优化了有向图邻接表的表达局限性，把邻接表和逆邻接表整合了。虽然结构显得复杂，但是创建算法的时间复杂度和邻接表相同，因此是个优秀的数据结构模型。

**D. 邻接多重表**

如果我们频繁调用顶点的话，那么邻接表是不错的选择；但是如果我们更关注是边的操作，比如对已经访问过的边做标记或删除，邻接表显得不那么方便，删除边(V0,V2)要删除两个顶点的邻接表结点。那么仿照十字链表，我们改造邻接表边表的结构，结点结构变为：
| iVertex | iLink | jVertex | jLink | 
|--|--|--|--|
其中iVertex和jVertex表示Vi和Vj两个顶点的下标，iLink是指向Vi下一条边的指针，jLink是Vj下一条边的指针。

![邻接多重表](https://user-images.githubusercontent.com/26374671/80811585-2ad9e380-8c01-11ea-9625-aa6de672ff8e.png)

**E. 边集数组**

边集数组是由两个一位数组构成，一个是存储顶点信息，另一个是存储边的信息。这个记录边信息的边数组中，每个数据元素由一条边的起点下标（begin）、终点下标（end）和权（weight）组成。一个边数组元素的结构：
|begin| end | weight|
|--|--|--|

